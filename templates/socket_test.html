{% extends 'index.html' %}

{% block title %}查询{%  endblock %}

{% block middlepart %}
    <div id="msg" class="shell" style="background-color: #1a1a1a; padding: 0 90px; color: #e1edf7;">
    </div>

    <script src="/static/js/jquery.min.js" ></script>
    <script>
        $(document).ready(function() {
            /* !window.WebSocket、window.MozWebSocket检测浏览器对websocket的支持*/
            if (!window.WebSocket) {
                if (window.MozWebSocket) {
                    window.WebSocket = window.MozWebSocket;
                } else {
                    $('#msg').prepend("<p>你的浏览器不支持websocket</p>");
                }
            }
            /* ws = new WebSocket 创建WebSocket的实例  注意设置对以下的websocket的地址哦*/
            ws = new WebSocket('ws://localhost:8000');
            /*
                ws.onopen  握手完成并创建TCP/IP通道，当浏览器和WebSocketServer连接成功后，会触发onopen消息
                ws.onmessage 接收到WebSocketServer发送过来的数据时，就会触发onmessage消息，参数evt中包含server传输过来的数据;
            */
            ws.onopen = function(evt) {
                $('#msg').append('<li>websocket连接成功</li>');
            };
            ws.onmessage = function(evt) {
                $('#msg').prepend('<li>' + evt.data + '</li>');
            }
        });
    </script>


{% endblock %}

